<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition template="/WEB-INF/includes/template/main.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
                xmlns:p="http://primefaces.org/ui">


    <ui:define name="content">
        <div class="content">
            <div class="row">
                <div class="col-md-6">
                    <ol class="breadcrumb">
                        <li><a href="solicitud.xhtml">Solicitud</a></li>
                        <li class="active">/ Nueva Solicitud</li>
                    </ol>
                </div>
                <div class="col-md-6"> 
                    <h:messages showDetail="true" styleClass="alert" style="list-style: none; padding: 0px; display: block" infoClass="alert-success" errorClass="alert-danger"/>
                </div>
            </div>
            <br/><br/><br/>
            <div class="container-fluid">
                <div class="main main-raised" style="background-image: url('#{request.contextPath}/resources/img/form-wizard-bg.jpg'); background-size: cover; background-position: top center;">
                    <div class="container" style="padding: 30px;">
                        <h:panelGroup id="exam">
                            <h:form id="formNuevaSolicitud" prependId="false" a:novalidate="novalidate">
                                <h3 class="card-title text-white text-center">Informaci√≥n General de Solicitud</h3>
                                <div class="row">                                    
                                    <div id="general" class="col-md-8">                                        
                                        <div class="form-group row">
                                            <div class="col-md-12">
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">
                                                            <i class="material-icons text-white">person</i>
                                                        </span>
                                                        <h4 class="card-title text-white">#{sessionController.usuarioSession().id} - #{sessionController.usuarioSession().nombres} #{sessionController.usuarioSession().apellidos}</h4>
                                                    </div>  
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-md-6">
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">
                                                            <i class="material-icons text-white">card_giftcard</i>
                                                        </span>
                                                    </div>
                                                    <h:selectOneMenu class="form-control selectpicker text-white" a:required="" 
                                                                     a:data-style="btn btn-link" value="#{solicitudController.nuevaSolicitud.tipoEvento}">
                                                        <f:selectItem itemValue="" itemLabel="Seleccione el tipo de evento..."/>
                                                        <f:selectItems value="#{solicitudController.tipoEventoList}" var="t" itemValue="#{t.id}" itemLabel="#{t.id} - #{t.tipo}"/>                                            
                                                    </h:selectOneMenu>   
                                                </div>
                                            </div>
                                            <div class="col-md-6 text-white">
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">
                                                            <i class="material-icons text-white">add_location</i>
                                                        </span>
                                                    </div>
                                                    <h:inputText class="form-control text-white" a:type="text" a:required="" a:placeholder="Direccion de Evento..."  
                                                                 value="#{solicitudController.nuevaSolicitud.direccion}"
                                                                 a:aria-invalid="false" >
                                                    </h:inputText>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-md-12 text-white">
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">
                                                            <i class="material-icons text-white">info</i>
                                                        </span>
                                                    </div>
                                                    <h:inputTextarea a:type="text" a:required="" a:placeholder="Escriba los detalles de su evento (sea tan especifico como desee)..."                                                                 
                                                                     a:aria-invalid="false" class="form-control text-white " 
                                                                     value="#{solicitudController.nuevaSolicitud.especificaciones}">
                                                    </h:inputTextarea>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-md-9 text-white">
                                                <div class="input-group">
                                                    <div class="input-group-prepend">
                                                        <span class="input-group-text">
                                                            <i class="material-icons text-white">date_range</i>
                                                        </span>
                                                    </div>
                                                    <h:inputText a:type="datetime" a:required="" a:placeholder="Escriba Fecha y hora (aaaa-MM-dd HH:mm)" 
                                                                 class="form-control text-white"
                                                                 value="#{solicitudController.nuevaSolicitud.fechaReserva}" a:aria-invalid="false">
                                                        <f:convertDateTime pattern="yyyy-MM-dd HH:mm"/>
                                                    </h:inputText>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <h3 class="card-title text-white text-center">Materiales de la Solicitud</h3>
                                <div class="row">
                                    <div id="general" class="col-md-6">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">
                                                    <i class="material-icons text-white">card_giftcard</i>
                                                </span>
                                            </div>
                                            <h:selectOneMenu class="form-control selectpicker text-white" a:required="" 
                                                             a:data-style="btn btn-link" value="#{solicitudController.idMaterial}">
                                                <f:selectItem itemValue="" itemLabel="Seleccione el material que desea..."/>
                                                <f:selectItems value="#{solicitudController.materialList}" var="t" itemValue="#{t.id}" itemLabel="#{t.tipoMaterial}"/>                                            
                                            </h:selectOneMenu>   
                                        </div>
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div id="general" class="col-md-6 text-center">
                                        <h:commandButton a:update="exam"  value="Agregar Material" 
                                                         action="#{solicitudController.agregarMaterial()}" class="btn btn-warning btn-lg- pull-right">
                                        </h:commandButton>
                                    </div>
                                </div>
                                <br/><br/>

                                <f:view>
                                    <div class="row d-flex justify-content-center">
                                        <div class="group scroll col-lg-11 col-md-11 text-white">
                                            <h:form prependId="false">
                                                <h:dataTable value="#{solicitudController.listCarrito}" var="item" class="table"  >
                                                    <h:column>
                                                        <f:facet name="header">
                                                            <h:outputText value="ID Material"/>
                                                        </f:facet>
                                                        <h:outputText value="#{item.id}"/>
                                                    </h:column>
                                                    <h:column>
                                                        <f:facet name="header">
                                                            <h:outputText value="Tipo Material"/>
                                                        </f:facet>
                                                        <h:outputText value="#{item.tipoMaterial}"/>
                                                    </h:column>
                                                    <h:column>
                                                        <f:facet name="header">
                                                            <h:outputText value="Estado"/>
                                                        </f:facet>
                                                        <h:outputText value="#{item.estado}"/>
                                                    </h:column>
                                                    <h:column>
                                                        <f:facet name="header">
                                                            <h:outputText value="Disponibilidad"/>
                                                        </f:facet>
                                                        <h:outputText value="#{item.disponilidad}"/>
                                                    </h:column>
                                                    <h:column>
                                                        <f:facet name="header">
                                                            <h:outputText value="Eliminar"/>
                                                        </f:facet>
                                                        <h:commandButton value="Cancelar" action="#{solicitudController.limpiarCarrito(item)}">
                                                        </h:commandButton>
                                                    </h:column>
                                                </h:dataTable>
                                            </h:form>
                                        </div>
                                    </div>
                                    <div class="footer-row text-center">
                                        <a class="btn btn-danger btn-flat btn-wd btn-lg-" href="#{request.contextPath}/SI/index.xhtml">Cancelar</a>
                                        &nbsp;&nbsp;
                                        <h:commandButton class="btn btn-primary btn-flat btn-wd btn-lg-" value="Enviar Solicitud" action="#{solicitudController.registrarSolicitud()}">
                                        </h:commandButton>
                                    </div>
                                </f:view>
                            </h:form>
                        </h:panelGroup>
                    </div>
                </div>
            </div>
        </div>
    </ui:define>
</ui:composition>

